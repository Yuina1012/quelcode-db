SELECT u.name, p.posted_at, c.name FROM posts AS p JOIN users AS u ON p.posted_by = u.id JOIN chat_rooms AS c ON p.chat_room_id = c.id WHERE p.is_deleted=0 AND u.is_deleted=0 AND posted_at IN(SELECT MAX(posted_at) FROM posts GROUP BY chat_room_id HAVING max(posted_at)) ORDER BY chat_room_id;
